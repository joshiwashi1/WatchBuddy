<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WatchBuddy | Profile</title>

  <!-- Icons & Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">

  <style>
    /* ===== COLOR SYSTEM (copied from Reviews + mapped to wb-*) ===== */
    :root {
      /* Reviews tokens */
      --primary-dark: #0c0d1b;
      --primary-navy: #151829;
      --accent-blue: #2563eb;
      --accent-purple: #7c3aed;
      --text-primary: #ffffff;
      --text-secondary: #a1a8c3;
      --text-muted: #6b7280;
      --surface-elevated: #1e2139;
      --surface-card: #252846;
      --border-subtle: #2d3348;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;

      /* map compatibility tokens */
      --wb-bg: var(--primary-dark);
      --wb-surface: #1e293b; /* slight depth for inputs */
      --wb-panel: var(--surface-card);
      --wb-border: var(--border-subtle);
      --wb-accent: var(--accent-blue);
      --wb-text: var(--text-primary);
      --wb-text-muted: var(--text-secondary);
      --wb-text-dark: #64748b;
      --wb-hover-bg: rgba(37, 99, 235, 0.15);
      --wb-hover-text: #ffffff;
      --wb-active-bg: rgba(37, 99, 235, 0.25);
      --wb-focus-shadow: rgba(37, 99, 235, 0.25);
      --wb-success: var(--success);
      --wb-warning: var(--warning);
      --wb-info: #06b6d4;
      --wb-danger: var(--danger);
    }

    * { box-sizing: border-box }
    body {
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-navy) 100%);
      color: var(--text-primary);
      font-family: 'Poppins', system-ui, -apple-system, sans-serif;
      line-height: 1.6;
      min-height: 100vh;
    }

    /* ===== Navbar (EXACT from Reviews) ===== */
    .navbar-brand {
      font-family: 'Orbitron', sans-serif !important;
      font-weight: 700;
      font-size: 1.25rem;
      text-decoration: none;
      color: var(--text-primary);
      transition: all 0.2s ease;
    }
    .navbar-brand:hover { color: var(--text-primary); transform: translateY(-1px); }
    .navbar-brand img {
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
      transition: all 0.3s ease;
    }
    .navbar-brand:hover img { transform: scale(1.05); box-shadow: 0 8px 24px rgba(37, 99, 235, 0.4); }

    .header {
      background: rgba(21, 24, 41, 0.8);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-subtle);
      padding: 1rem 0;
      position: sticky; top: 0; z-index: 100;
      transition: background .2s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .header.navbar-shadow {
      background: rgba(21, 24, 41, 0.92);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      border-bottom-color: rgba(45,55,72,.6);
    }

    .nav { display: flex; align-items: center; justify-content: space-between; }
    .nav-links { display: flex; gap: 2rem; list-style: none; }
    .nav-link {
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 400;
      padding: .5rem 0;
      position: relative;
      transition: color .2s;
    }
    .nav-link:hover, .nav-link.active { color: var(--text-primary); }
    .nav-link.active::after {
      content: '';
      position: absolute; bottom: -1rem; left: 0; right: 0; height: 2px;
      background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
    }

    .user-profile { display: flex; align-items: center; gap: .75rem; color: var(--text-secondary); }
    .user-avatar {
      width: 32px; height: 32px; border-radius: 50%;
      background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
      display: flex; align-items: center; justify-content: center;
      color: #fff; font-weight: 500; font-size: .9rem;
    }

    /* Dark dropdown (from Reviews) */
    .dropdown-menu { background: #1e2139; border: 1px solid var(--border-subtle); border-radius: 12px; overflow: hidden; }
    .dropdown-item { color: #e5e7eb; }
    .dropdown-item:hover { background: rgba(37,99,235,.25); color: #fff; }
    .dropdown-divider { border-color: var(--border-subtle); }

    /* ===== Cards / Controls: palette only (no size changes) ===== */
    .card { background: var(--surface-card); border: 1px solid var(--border-subtle); border-radius: 16px; box-shadow: 0 4px 10px rgba(0,0,0,.15); }
    .card-title { color: var(--text-primary); font-weight: 600; }
    .card-text { color: var(--text-secondary); }
    .form-label { color: var(--text-primary); font-weight: 500; }
    .form-control, .form-select { background: var(--surface-elevated); color: var(--text-primary); border: 1px solid var(--border-subtle); border-radius: 12px; }
    .form-control::placeholder { color: var(--text-muted); }
    .form-control:focus, .form-select:focus { border-color: var(--accent-blue); box-shadow: 0 0 0 .25rem rgba(37,99,235,.25); }
    .btn-primary { background: var(--accent-blue); border-color: var(--accent-blue); }
    .btn-primary:hover { background: #1d4ed8; border-color: #1d4ed8; }
    .btn-outline-primary { color: var(--accent-blue); border-color: var(--accent-blue); }
    .btn-outline-primary:hover { background: var(--accent-blue); color: #fff; }

    /* ===== Profile header surfaces ===== */
    .cover {
      position: relative; border-radius: 16px; overflow: hidden;
      background: linear-gradient(135deg, rgba(37,99,235,.2), rgba(21,24,41,.85)), linear-gradient(45deg, #1e2139, #252846);
      min-height: 200px; border: 1px solid var(--border-subtle);
    }
    .avatar-lg {
      width: 120px; height: 120px; border-radius: 50%; object-fit: cover;
      border: 4px solid rgba(37,99,235,.35);
      background: var(--surface-elevated); box-shadow: 0 8px 20px rgba(0,0,0,.35);
    }

    .stats-icon { width: 56px; height: 56px; border-radius: 50%; display: grid; place-items: center; font-size: 1.25rem; background: var(--surface-elevated); margin-bottom: .75rem; }
    .stats-icon.to-watch { background: rgba(6,182,212,.2); color: #67e8f9; }
    .stats-icon.watching { background: rgba(245,158,11,.2); color: #fbbf24; }
    .stats-icon.completed { background: rgba(34,197,94,.2); color: #4ade80; }

    .review-item { padding: 1rem; border-radius: 12px; background: var(--surface-elevated); border: 1px solid var(--border-subtle); margin-bottom: 1rem; }
    .review-item:last-child { margin-bottom: 0; }
    .text-warning { color: var(--warning) !important; }

    footer.wb-footer { background: var(--surface-card); border-top: 1px solid var(--border-subtle); color: var(--text-secondary); }

    @media (max-width: 768px) {
      .cover { min-height: 160px; }
      .avatar-lg { width: 84px; height: 84px; }
      .stats-icon { width: 48px; height: 48px; font-size: 1.1rem; }
    }
  </style>
</head>

<body data-page="profile">
  <!-- Navbar (EXACT copy from Reviews) -->
  <header class="header">
    <nav class="nav container">
      <a class="navbar-brand fw-bold d-flex align-items-center" href="dashboard.html">
        <img src="assets/img/logo.png" alt="WatchBuddy Logo" width="36" height="36" class="me-2 rounded-2">
        WatchBuddy
      </a>
      <ul class="nav-links">
        <li><a href="dashboard.html" class="nav-link">Dashboard</a></li>
        <li><a href="movies.html" class="nav-link">Movies</a></li>
        <li><a href="reviews.html" class="nav-link">Reviews</a></li>
      </ul>

      <!-- User menu (exact structure) -->
      <div class="dropdown">
        <button class="user-profile dropdown-toggle" id="userMenuBtn" data-bs-toggle="dropdown" aria-expanded="false" style="background:none;border:0;">
          <span id="userFirst">User</span>
          <div class="user-avatar" id="userAvatar">U</div>
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" href="profile.html"><i class="bi bi-gear me-2"></i>Profile Settings</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><button class="dropdown-item" id="logoutBtn" type="button"><i class="bi bi-box-arrow-right me-2"></i>Logout</button></li>
        </ul>
      </div>
    </nav>
  </header>

  <!-- Main -->
  <main class="container-fluid py-4">
    <!-- Header -->
    <section class="cover mb-5">
      <div class="container py-4 position-relative" style="min-height: 200px;">
        <div class="d-flex flex-column flex-md-row align-items-md-end gap-3">
          <img src="https://ui-avatars.com/api/?name=Test&background=0D8ABC&color=fff&size=120" alt="Avatar" class="avatar-lg">
          <div class="mb-2">
            <h1 class="h2 fw-bold mb-2 text-white">Test</h1>
            <div class="text-light opacity-75 mb-2"><span>test@gmail.com</span> · <span>Cebu, Philippines</span></div>
          </div>
          <div class="ms-md-auto d-flex gap-2">
            <button class="btn btn-outline-primary btn-sm"><i class="bi bi-image me-1"></i>Change Avatar</button>
            <button class="btn btn-primary btn-sm"><i class="bi bi-pencil-square me-1"></i>Edit Profile</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Content -->
    <section class="container">
      <div class="row g-4">
        <!-- Left column -->
        <div class="col-12 col-xl-8">
          <!-- About -->
          <div class="card mb-4">
            <div class="card-body">
              <h2 class="h5 fw-bold mb-3 text-white">About</h2>
              <p class="card-text mb-3">Movie night curator. Loves heist films, slow-burn series, and anything Studio Ghibli inspired ✨</p>
            </div>
          </div>

          <!-- Stats -->
          <div class="row g-3 mb-4">
            <div class="col-12 col-sm-6 col-lg-4">
              <div class="card h-100 text-center p-3">
                <div class="stats-icon to-watch mx-auto"><i class="bi bi-bookmark-plus"></i></div>
                <div class="h4 fw-bold mb-1 text-white">12</div>
                <div class="text-light small">To Watch</div>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
              <div class="card h-100 text-center p-3">
                <div class="stats-icon watching mx-auto"><i class="bi bi-play-circle"></i></div>
                <div class="h4 fw-bold mb-1 text-white">3</div>
                <div class="text-light small">Watching</div>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-lg-4">
              <div class="card h-100 text-center p-3">
                <div class="stats-icon completed mx-auto"><i class="bi bi-check-circle"></i></div>
                <div class="h4 fw-bold mb-1 text-white">48</div>
                <div class="text-light small">Completed</div>
              </div>
            </div>
          </div>

          <!-- Recent Reviews -->
          <div class="card mb-4">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="h5 fw-bold mb-0 text-light">Recent Reviews</h2>
                <a class="btn btn-outline-primary btn-sm" href="dashboard.html"><i class="bi bi-collection me-1"></i>Go to Watchlist</a>
              </div>

              <div class="review-item">
                <div class="d-flex gap-3">
                  <img src="assets/img/posters/poster-01.jpg" alt="La La Land Poster" width="54" height="80" class="rounded">
                  <div class="flex-grow-1">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                      <strong class="text-white">La La Land</strong>
                      <span class="text-warning"><i class="bi bi-star-fill"></i> 4.5</span>
                    </div>
                    <p class="small mb-2 text-light">Whimsical, heartbreaking, and gorgeous. The score lives rent-free in my head.</p>
                    <div class="small text-light">Reviewed on Sep 10, 2025</div>
                  </div>
                </div>
              </div>

              <div class="review-item">
                <div class="d-flex gap-3">
                  <img src="assets/img/posters/poster-02.jpg" alt="Inception Poster" width="54" height="80" class="rounded">
                  <div class="flex-grow-1">
                    <div class="d-flex justify-content-between align-items-start mb-2">
                      <strong class="text-white">Inception</strong>
                      <span class="text-warning"><i class="bi bi-star-fill"></i> 5.0</span>
                    </div>
                    <p class="small mb-2 text-light">Mind-bending and brilliant. Nolan at his best.</p>
                    <div class="text-light small">Reviewed on Sep 8, 2025</div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- Right column: Quick Settings -->
        <div class="col-12 col-xl-4">
          <div class="card">
            <div class="card-body">
              <h2 class="h5 fw-bold mb-4 text-light">Quick Settings</h2>

              <div class="mb-3">
                <label class="form-label">Display Name</label>
                <input type="text" class="form-control text-muted" value="Test" disabled readonly>
              </div>

              <div class="mb-3">
                <label class="form-label">Username</label>
                <div class="input-group">
                  <span class="input-group-text">@</span>
                  <input type="text" class="form-control text-muted" value="test@gmail.com" disabled readonly>
                </div>
              </div>

              <div class="mb-3">
                <label class="form-label">Location</label>
                <input type="text" class="form-control text-muted" value="Cebu, Philippines" disabled readonly>
              </div>

            </div>
          </div>
        </div>

      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="wb-footer py-4 mt-auto">
    <div class="container d-flex flex-column flex-md-row align-items-center justify-content-between gap-2">
      <div class="small">Made with ❤️ for movie lovers</div>
      <div class="small">© <span id="year"></span> WatchBuddy</div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
  // Show current year
  document.getElementById('year').textContent = new Date().getFullYear();

  // Navbar shadow behavior
  const headerEl = document.querySelector('.header');
  const onScroll = () => { if (headerEl) headerEl.classList.toggle('navbar-shadow', window.scrollY > 8); };
  onScroll();
  window.addEventListener('scroll', onScroll);

  // Load current logged-in user
  async function loadUser() {
    try {
      const res = await fetch('/watchbuddy/backend/public/api/me', { credentials: 'include' });
      const data = await res.json();
      if (data?.ok && data.user) {
        const first = data.user.first_name || data.user.name || (data.user.email || 'User').split('@')[0];
        document.getElementById('userFirst').textContent = first;
        document.getElementById('userAvatar').textContent = first[0].toUpperCase();
      }
    } catch (err) {
      console.error('Failed to load user:', err);
    }
  }
  loadUser();  

  // Logout handler
  document.getElementById('logoutBtn')?.addEventListener('click', async () => {
    try { await fetch('/watchbuddy/backend/public/api/logout', { method: 'POST', credentials: 'include' }); } catch(_) {}
    location.href = 'login.html';
  });
</script>

</body>

</html>
